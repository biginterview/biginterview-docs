# Partner API: Endpoints

## Users

A user is a unique record who shares a single account between your partner
application and Big Interview.

Endpoints that resuly in the creation of a user account also handle the initial
generation **Single Sign On** tokens. All responses to these endpoints will
include a `token` object as part of the response. These tokens follow the same
rules outlined in the [Create/Refresh a User][user-create] endpoint.

### Create an Anonymous User

<h4 class="request-type">
  <span class="label post">POST</span>
  <code>/api/users/anonymous</code>
</h4>

Anonymous users are simply temporary user's whose `partner_id` is generated by
the API. Read the [Anonymous Users][anon] section for more information.

#### Request

```http
POST /api/users/anonymous HTTP/1.1
Host: {org}.biginterview.com
Accept: application/json
Authorization: {api-key}
```

#### Response

| Code | Description |
|------|-------------|
| 201  | Anonymous user account was created. |

```json
{
  "user": {
    "partner_id": "anon_abc123",
    "created_at": "2015-01-01T00:00:00.000Z",
    "anonymous": true,
    "token": {
      "token": "19633c68a809dda515d78bbee308012634b73f4142b4ae58d8790c7094c66417",
      "expires_at": "2016-05-28T17:16:18.817Z"
    }
  }
}
```

### Create/Refresh a User

<h4 class="request-type">
  <span class="label post">POST</span>
  <code>/api/users/{partner_id}</code>
</h4>

Creating a User or refreshing their token in the Big Interview system both
can be done with the same endpoint. This simplifies the process of ensuring User
accounts exist on our system and reduces the functional and logical overhead on
your end. Essentially, this endpoint is idempotent. User accounts are never
duplicated, and the parameters required during create are simply ignore when
submitted for an existing user.

#### Partner ID

As noted in the [Identifying Users][user-id] section, it is your responsibility
to ensure that the `partner_id` is unique in your system for the user being
created. That attribute is supplied here as part of the URI structure. For
example, a user with a partner id of `123` will have the URI endpoint
`/api/users/123`.

There is currently no way to update an existing user's `partner_id` in our
system.

#### Tokens

This endpoint also returns a `token` object in it's response. Tokens allow
user's from your application to login to Big Interview through our Single Sign
On integration without the need to enter password. That process utilizes
tokens generated by this endpoint.

#### Token Expiration

**All tokens expire 48-hours after they are created.** They cannot be used as
part of our SSO integration after they expire, however, a user's token is
automatically refreshed when making a call to this endpoint.

#### Params

<div class="alert alert-info">
  These parameters are <strong>required when creating a user</strong> and
  <strong>ignored when updating a user</strong>.
</div>

| Param | Type | Required | Desc |
|-------|------|----------|------|
| **first_name** | `String` | **Creation Only** | The first name of the user. |
| **last_name** | `String` | **Creation Only** | The last name of the user. |
| **email** | `String` | **Creation Only** | The email address of the user. |

#### Request

```http
POST /api/users/{partner_id} HTTP/1.1
Host: {org}.biginterview.com
Accept: application/json
Authorization: {api-key}
```

#### Response

| Code | Description |
|------|-------------|
| 200 | User account was updated successfully. |
| 201 | User account was created successfully. |
| 422 | Provided attributes were invalid. (See message for more information) |

```json
{
  "user": {
    "partner_id": "{partner_id}",
    "created_at": "2015-01-01T00:00:00.000Z",
    "anonymous": false,
    "token": {
      "token": "19633c68a809dda515d78bbee308012634b73f4142b4ae58d8790c7094c66417",
      "expires_at": "2016-05-28T17:16:18.817Z"
    }
  }
}
```

### Retrieve Track Progress

<h4 class="request-type">
  <span class="label get">GET</span>
  <code>/api/users/{partner_id}/tracks</code>
</h4>

Big Interview currently offers two guided learning tracks to get users started
utilizing all the content the service has to offer. In the app, we display this
information as a progress bar linked to a panel presenting a step-by-step guide
to completing the track:

![App Tracks](/assets/images/api/app_tracks.png)

Through this endpoint, you can access the exact same information displayed on
these panels and display it back to users inside your application.

#### Request

```http
GET /api/users/{partner_id}/tracks HTTP/1.1
Host: {org}.biginterview.com
Accept: application/json
Authorization: {api-key}
```

#### Response

| Code | Description |
|------|-------------|
| 200 | User track progress information was loaded. |
| 404 | User whose progress is being requested does not exist. |

```json
{
  "tracks": [
    {
      "title": "Fast Track",
      "progress": 1.00,
      "tracks": [
        {
          "step": 1,
          "title": "Tell me about yourself",
          "link": "/members/curriculum?chapter=5",
          "completed": true
        }
      ]
    },
    {
      "title": "Mastery Track",
      "progress": 0.50,
      "tracks": [
        {
          "step": 1,
          "title": "Job Interview Fundamentals",
          "link": "/members/curriculum?chapter=1",
          "completed": true
        },
        {
          "step": 2,
          "title": "Why do you want to work here?",
          "link": "/members/curriculum?chapter=6",
          "completed": false
        }
      ]
    }
  ]
}
```

### Retrieve Interview Progress

<h4 class="request-type">
  <span class="label get">GET</span>
  <code>/api/users/{partner_id}/interviews</code>
</h4>

The ability to participate in mock interview sessions is one of the defining
features of the Big Interview application. Through this endpoint, you can
access information pertaining to these interviews for a specific user.

<div class="alert alert-info">
  This endpoint returns every interview the user has associated with their
  account ordered by most recently updated to least recently updated.
</div>

#### The interview object

| Parameter | Type | Description |
|-----------|------|-------------|
| `id` | **Integer** | The id for interview object specific to the user being request. |
| `title` | **String** | The title of the interview. |
| `interviewer_name` | **String** | The name of the interviewer asking the first question for the set. |
| `category` | **String** | The category title for this interview. **Use for display purposes only.** |
| `created_at` | **Date** | The date this interview was created at in JSON ISO 8601 format.
| `updated_at` | **Date** | The date this interview was last updated at (last activity) in JSON ISO 8601 format.
| `links.review` | **String** | The redirect path to review a completed or in-progress interview. |
| `links.retake` | **String** | The redirect path to start an entirely new interview with these same questions. **This means a new interview will be created**. |

#### Request

```http
GET /api/users/{partner_id}/interviews HTTP/1.1
Host: {org}.biginterview.com
Accept: application/json
Authorization: {api-key}
```

#### Response

| Code | Description |
|------|-------------|
| 200 | User track progress information was loaded. |
| 404 | User whose progress is being requested does not exist. |

```json
{
   "interviews": [
      {
         "id": 95607,
         "title": "Top 10 Questions",
         "interviewer_name": "Jordan",
         "category": "Top 10 Questions: 1",
         "completed": true,
         "created_at": "2015-05-18T16:37:13.000Z",
         "updated_at": "2015-05-25T05:00:00.000Z",
         "links": {
            "review": "/members/mock_interviews/95607/review",
            "retake": "/members/mock_interviews/interview_info/52"
         }
      },
      {
         "id": 91412,
         "title": "My Best Analytical Interview",
         "interviewer_name": "Mark",
         "category": "Competency/Skillset: Analytical Skills",
         "completed": false,
         "created_at": "2015-04-30T20:44:21.000Z",
         "updated_at": "2015-05-01T21:00:10.000Z",
         "links": {
            "review": "/members/mock_interviews/91412/review",
            "retake": "/members/mock_interviews/interview_info/443"
         }
      }
   ]
}
```

[anon]: #anonymous-users
[user-id]: #user-id
[user-create]: #create-refresh-a-user
