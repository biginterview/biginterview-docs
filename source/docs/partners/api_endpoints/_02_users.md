## Users

A user is a unique record who shares a single account between your partner
application and Big Interview.

Endpoints that result in the creation of a user account also handle the initial
generation of [**Single Sign On**][sso] tokens. All responses to these endpoints
will include a `token` object as part of the response. These tokens follow the
same rules outlined in the [Create/Refresh a User][user-create] endpoint.

### The user object

The following describes the attributes related to a response containing user
information.

| Parameter | Type | Description |
|-----------|------|-------------|
| `partner_id` | **String** | The id that is unique to this user scoped to your organization. |
| `anonymous` | **Boolean** | If this user is [anonymous][anon] or has a regular account. |
| `created_at` | **Date** | The date this user account was created in JSON ISO 8601 format. |
| `token.token` | **String** | The token that can be used to login the user through our [SSO][sso] integration. |
| `token.expires_at` | **Date** | The exact time that the given token expires. |

```json
{
  "partner_id": "anon_abc123",
  "anonymous": true,
  "created_at": "2015-01-01T00:00:00.000Z",
  "token": {
    "token": "19633c68a809dda515d78bbee308012634b73f4142b4ae58d8790c7094c66417",
    "expires_at": "2016-05-28T17:16:18.817Z"
  }
}
```


### Create an Anonymous User

<h4 class="request-type">
  <span class="label post">POST</span>
  <code>/api/users/anonymous</code>
</h4>

Anonymous users are simply temporary user's whose `partner_id` is generated by
the API. Read the [Anonymous Users][anon] section for more information.

#### Request

```http
POST /api/users/anonymous HTTP/1.1
Host: {org}.biginterview.com
Accept: application/json
Authorization: {api-key}
```

#### Response

| Code | Description |
|------|-------------|
| 201  | Anonymous user account was created. |

```json
{
  "user": {
    "partner_id": "{partner_id}",
    "anonymous": false,
    "created_at": "2015-01-01T00:00:00.000Z",
    "token": {
      "token": "19633c68a809dda515d78bbee308012634b73f4142b4ae58d8790c7094c66417",
      "expires_at": "2016-05-28T17:16:18.817Z"
    }
  }
}
```

### Create/Refresh a User

<h4 class="request-type">
  <span class="label post">POST</span>
  <code>/api/users/{partner_id}</code>
</h4>

Creating a User or refreshing their token in the Big Interview system both
can be done with the same endpoint. This simplifies the process of ensuring User
accounts exist on our system and reduces the functional and logical overhead on
your end. Essentially, this endpoint is idempotent. User accounts are never
duplicated, and the parameters required during create are simply ignore when
submitted for an existing user.

#### Partner ID

As noted in the [Identifying Users][user-id] section, it is your responsibility
to ensure that the `partner_id` is unique in your system for the user being
created. That attribute is supplied here as part of the URI structure. For
example, a user with a partner id of `123` will have the URI endpoint
`/api/users/123`.

There is currently no way to update an existing user's `partner_id` in our
system.

#### Tokens

This endpoint also returns a `token` object in it's response. Tokens allow
user's from your application to login to Big Interview through our
[Single Sign On][sso] integration without the need to enter a password. That
process utilizes tokens generated by this endpoint.

#### Token Expiration

**All tokens expire 48-hours after they are created.** They cannot be used as
part of our SSO integration after they expire, however, a user's token is
automatically refreshed when making a call to this endpoint.

#### Params

<div class="alert alert-info">
  These parameters are <strong>required when creating a user</strong> and
  <strong>ignored when updating a user</strong>.
</div>

| Param | Type | Required | Desc |
|-------|------|----------|------|
| **first_name** | `String` | **Creation Only** | The first name of the user. |
| **last_name** | `String` | **Creation Only** | The last name of the user. |
| **email** | `String` | **Creation Only** | The email address of the user. |

#### Request

```http
POST /api/users/{partner_id} HTTP/1.1
Host: {org}.biginterview.com
Accept: application/json
Authorization: {api-key}
```

#### Response

| Code | Description |
|------|-------------|
| 200 | User account was updated successfully. |
| 201 | User account was created successfully. |
| 422 | Provided attributes were invalid. (See message for more information) |

```json
{
  "user": {
    "partner_id": "{partner_id}",
    "created_at": "2015-01-01T00:00:00.000Z",
    "anonymous": false,
    "token": {
      "token": "19633c68a809dda515d78bbee308012634b73f4142b4ae58d8790c7094c66417",
      "expires_at": "2016-05-28T17:16:18.817Z"
    }
  }
}
```

[anon]: #anonymous-users
[sso]: #single-sign-on
[user-id]: #user-id
[user-create]: #create-refresh-a-user
